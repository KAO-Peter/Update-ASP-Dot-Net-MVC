@model IEnumerable<HRPortal.SignFlow.Model.HRPotralFormSignStatus>
@using PagedList
@using PagedList.Mvc
@using System.Resources;
@{
    var data = Model as IPagedList<HRPortal.SignFlow.Model.HRPotralFormSignStatus>;
}
        <div class="col-xs-12">
            @if (Model != null)
            {
                <div class="table-responsive">
                    <table id="grid-table" tabindex="0" cellspacing="0" cellpadding="0" border="0" class="table table-bordered ui-jqgrid ui-widget ui-widget-content ui-corner-all">
                        <tr class="ui-jqgrid-labels" role="rowheader" style="height: 40px; color: #777">
                             <!-- 2019/04/15 Neo 調整部門欄位寬度變大 -->
                            <th id="grid-table_code" role="columnheader" class="" style="width: 8%">
                                <div id="jqgh_grid-table_code" class="ui-jqgrid-sortable" style="text-align: center;">@HRPortal.MultiLanguage.Resource.Date</div>
                            </th>
                            <th id="grid-table_classified_code_name" role="columnheader" class="" style="width: 6%">
                                <div id="jqgh_grid-table_classified_code_name" class="ui-jqgrid-sortable" style="text-align: center;">@HRPortal.MultiLanguage.Resource.Type</div>
                            </th>
                            <th id="grid-table_category_name" role="columnheader" class="" style="width: 35%;">
                                <div id="jqgh_grid-table_category_name" class="ui-jqgrid-sortable" style="text-align: center;">@HRPortal.MultiLanguage.Resource.AnnouncementContentext</div>
                            </th>
                            <th id="grid-table_teacher_name" role="columnheader" class="" style="width: 17%; min-width: 130px;">
                                <div id="jqgh_grid-table_teacher_name" class="ui-jqgrid-sortable" style="text-align: center;">@HRPortal.MultiLanguage.Resource.Department</div>
                            </th>
                            <th id="grid-table_count" role="columnheader" class="" style="width: 8%;">
                                <div id="jqgh_grid-table_count" class="ui-jqgrid-sortable" style="text-align: center;">@HRPortal.MultiLanguage.Resource.applicant</div>
                            </th>
                            <th id="grid-table_notification_count" role="columnheader" class="" style="width: 8%;">
                                <div id="jqgh_grid-table_notification_count" class="ui-jqgrid-sortable" style="text-align: center;">@HRPortal.MultiLanguage.Resource.DeptType</div>
                            </th>
                            <th id="grid-table_notification_count2" role="columnheader" class="" style="width: 8%;">
                                <div id="jqgh_grid-table_notification_count2" class="ui-jqgrid-sortable" style="text-align: center;">@HRPortal.MultiLanguage.Resource.Signstate</div>
                            </th>
                            <th id="grid-table_id" role="columnheader" class="" style="width: 10%;">
                                <div id="jqgh_grid-table_id" class="ui-jqgrid-sortable"></div>
                            </th>

                        </tr>
                        @if (Model != null && Model.Count() > 0)
                        {
                            ResourceManager _resourceManager = new ResourceManager("HRPortal.MultiLanguage.Resource", typeof(HRPortal.MultiLanguage.Resource).Assembly);
                            foreach (var item in Model)
                            {
                            <tr role="row" id="@item.FormNo" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr">
                                @Html.HiddenFor(m => item.FormType)
                                @Html.HiddenFor(m => item.FormNo)
                                <!-- 2019/04/15 Neo 調整填表日期欄請同其他欄位一樣置上 -->
                                <td role="gridcell" style="white-space: normal" aria-describedby="grid-table_code">
                                    @if (item.FormCreateDate > new DateTime(1911, 1, 1))
                                    {
                                        @item.FormCreateDate.ToString("yyyy/MM/dd")    
                                    }
                                </td>
                                <td role="gridcell" style="" aria-describedby="grid-table_classified_code_name">@(_resourceManager.GetString(item.FormType.ToString()) ?? item.FormType.ToString())</td>
                                <td role="gridcell" style="" aria-describedby="grid-table_category_name">@item.FormSummary</td>
                                <td role="gridcell" style="white-space: normal" aria-describedby="grid-table_notification_count">@(ViewBag.LanguageCookie == "en-US" ? item.DepartmentEnglishName : item.DepartmentName)</td>
                                <td role="gridcell" style="white-space: normal" aria-describedby="grid-table_notification_count">@(ViewBag.LanguageCookie == "en-US" ? item.SenderEmployeeEnglishName : item.SenderEmployeeName)</td>

                                @if (item.SignFlowID == null || item.SignFlowID == "")
                                {
                                    <td role="gridcell" style="white-space: normal" aria-describedby="grid-table_notification_count"></td>
                                    <td role="gridcell" style="white-space: normal" aria-describedby="grid-table_notification_count"></td>
                                    <!--<td role="gridcell" style="white-space:normal" aria-describedby="grid-table_notification_count"></td>-->
                                }
                                else
                                {
                                    <td role="gridcell" style="white-space: normal" aria-describedby="grid-table_notification_count">@(ViewBag.LanguageCookie == "en-US" ? item.SignerEmployeeEnglishName : item.SignerEmployeeName)</td>
                                    <td role="gridcell" style="white-space: normal" aria-describedby="grid-table_notification_count">@(item.SignStatus == "W" ? (item.SignType == "S" ? HRPortal.MultiLanguage.Resource.SignStatus_NotSent : HRPortal.MultiLanguage.Resource.SignStatus_EnRoute) : (item.SignStatus == "R" ? HRPortal.MultiLanguage.Resource.SignStatus_Rejected : (item.SignStatus == "S" ? HRPortal.MultiLanguage.Resource.SignStatus_EnRoute : (item.SignStatus == "B" ? HRPortal.MultiLanguage.Resource.SignStatus_TakenBack : HRPortal.MultiLanguage.Resource.SignStatus_Approved))))</td>
                                }
                                <td role="gridcell" style="white-space: normal; text-align: center" aria-describedby="grid-table_notification_count">
                                    <a class="btn btn-default" data-toggle="modal" data-target="#myModal" onclick="loadFormDetail('@item.FormType.ToString()', '@item.FormNo', '@item.SignFlowID', '@item.FormNoOrder')">@HRPortal.MultiLanguage.Resource.Detailss</a>
                                </td>
                            </tr>
                            }
                        }
                        else
                        {
                            <tr role="row" tabindex="-1" class="ui-widget-content jqgrow ui-row-ltr">
                                <td colspan="8" style="text-align: center">
                                    @HRPortal.MultiLanguage.Resource.NoData
                                </td>
                            </tr>
                        }
                    </table>
                </div>
        <div style="text-align: center">
            @if (Model != null && Model.Count() > 0)
            {
                @Html.PagedListPager(data, page => Url.Action("Index", new { page }), PagedListRenderOptions.ClassicPlusFirstAndLast)
                @Html.PagedListPager(data, page => Url.Action("Index"), new PagedListRenderOptions
                                                  {
                                                      DisplayLinkToFirstPage = PagedListDisplayMode.Never,
                                                      DisplayLinkToLastPage = PagedListDisplayMode.Never,
                                                      DisplayLinkToPreviousPage = PagedListDisplayMode.Never,
                                                      DisplayLinkToNextPage = PagedListDisplayMode.Never,
                                                      DisplayLinkToIndividualPages = false,
                                                      DisplayPageCountAndCurrentLocation = true,
                                                      PageCountAndCurrentLocationFormat = @HRPortal.MultiLanguage.Resource.Pageof,
                                                      DisplayItemSliceAndTotal = true,
                                                      ItemSliceAndTotalFormat = @HRPortal.MultiLanguage.Resource.ofrow
                                                  })
            }
        </div>
            }
        </div>
<script type="text/javascript">
    $(function () {
        $.each($('.pagination-container li a'), function () {
            if ($(this).attr('href') != null) {
                var page = $(this).attr('href');
                page = page.substr(page.indexOf('?page=') + 6);

                $(this).attr('href', 'javascript:goPage(\'' + page + '\');');
            }
        });
    });
</script>
